# 家計簿アプリ設計書

## 1. プロジェクト概要

### 目的
夫婦と子供の家族構成で、個人と共通の口座・カードを一元管理できる家計簿アプリ

### 想定ユーザー
- 夫婦と子供（複数人）の家族
- 1人が全体を管理
- 個人用（夫・妻それぞれ）と共通用の財布・口座・カードが存在

---

## 2. コア機能

### 2.1 アカウント管理
- **口座タイプ**:
  - 個人口座（夫）
  - 個人口座（妻）
  - 共通口座（家族共通）
- **支払い手段**:
  - 現金（財布）
  - 銀行口座
  - クレジットカード/デビットカード（複数枚対応）
  - 電子マネー（オプション）

### 2.2 取引記録
- **収入記録**:
  - 給与（夫/妻）
  - 賞与
  - その他収入
  - どの口座に入金されたか
- **支出記録**:
  - 日付
  - 金額
  - カテゴリ（後述）
  - 支払い元（どの口座/カード/財布から）
  - メモ（任意）
  - レシート画像（オプション）

### 2.3 カテゴリ管理
- **共通支出カテゴリ例**:
  - 食費
  - 日用品
  - 光熱費
  - 通信費
  - 家賃/住宅ローン
  - 教育費
  - 医療費
  - 交通費
  - 娯楽費
  - その他

- **個人支出カテゴリ例**:
  - 衣服
  - 趣味
  - 交際費
  - その他個人

### 2.4 資産管理
- **残高管理**:
  - 各口座の残高
  - 各カードの利用額/請求額
  - 現金残高
- **月次集計**:
  - 月ごとの収支
  - カテゴリ別支出
  - 口座別残高推移
- **カード請求管理**:
  - カード別の今月利用額
  - 次回請求予定額
  - 引き落とし予定日

---

## 3. 画面構成（案）

### 3.1 ダッシュボード（ホーム画面）
- **収支サマリーカード**
  - 今月の収入・支出・残高（大きく表示）
  - 先月比の増減（アイコン付き）
- **口座残高一覧**
  - 各口座をカードで表示（色分け）
  - 残高と前月比
- **カテゴリ別支出**
  - 円グラフまたはドーナツグラフ
  - 上位5カテゴリ
- **予算達成状況**
  - カテゴリ別のプログレスバー
  - 予算超過時は赤色表示
- **カード請求一覧**
  - 今月の請求予定額
  - 引き落とし予定日
- **最近の取引**
  - 直近5-10件をカード形式で表示

### 3.2 取引登録画面
- **クイック入力モード**
  - 収入/支出のタブ切替
  - 大きな金額入力エリア
  - カテゴリをアイコン付きボタンで選択
  - 支払い元を色分けボタンで選択
  - 日付選択（デフォルトは今日）
  - メモ入力（任意）
- **登録ボタン**（目立つ配色）
- **最近使ったカテゴリのショートカット**

### 3.3 取引一覧画面
- **フィルター**
  - 月選択（スライダーまたはカレンダー）
  - カテゴリ選択（チップ形式）
  - 口座選択（チップ形式）
  - 収入/支出の切替
- **取引リスト**
  - カード形式で表示
  - カテゴリアイコン・色付き
  - スワイプで編集/削除（モバイル対応）
- **検索機能**
  - メモやカテゴリで検索

### 3.4 統計画面
- **月別収支グラフ**
  - 折れ線グラフまたは棒グラフ
  - 収入・支出・残高の推移
  - 過去6ヶ月分
- **カテゴリ別支出**
  - 円グラフ + 詳細リスト
  - カテゴリごとの金額と割合
- **予算vs実績**
  - カテゴリ別の比較グラフ
  - 達成率の色分け（緑/黄/赤）
- **口座別残高推移**
  - 積み上げ棒グラフ

### 3.5 設定画面
- **口座管理**
  - 口座/カードの追加・編集・削除
  - アイコンと色の選択
  - タイプ（夫/妻/共通）の設定
- **カテゴリ管理**
  - カテゴリの追加・編集・削除
  - アイコンと色の選択
  - スコープ（共通/夫/妻）の設定
- **予算設定**
  - カテゴリ別の月予算設定
  - 前月コピー機能
- **データ管理**
  - データのエクスポート/インポート（JSON）
  - データの初期化

---

## 4. データ構造（案）

### 4.1 Account（口座）
```typescript
type AccountType = 'husband_personal' | 'wife_personal' | 'family_common';
type PaymentMethod = 'cash' | 'bank' | 'credit_card' | 'debit_card' | 'emoney';

interface Account {
  id: string;
  name: string; // 例: "夫メイン銀行", "共通財布", "夫楽天カード"
  type: AccountType;
  paymentMethod: PaymentMethod;
  balance: number;
  color: string; // UI表示用
}
```

### 4.2 Transaction（取引）
```typescript
type TransactionType = 'income' | 'expense';

interface Transaction {
  id: string;
  date: string; // ISO8601
  type: TransactionType;
  amount: number;
  categoryId: string;
  accountId: string; // どの口座/カードから
  memo?: string;
  receiptImageUrl?: string;
  createdAt: string;
  updatedAt: string;
}
```

### 4.3 Category（カテゴリ）
```typescript
type CategoryScope = 'common' | 'husband' | 'wife';

interface Category {
  id: string;
  name: string;
  scope: CategoryScope;
  color: string;
  icon?: string;
}
```

### 4.4 Budget（予算）
```typescript
interface Budget {
  id: string;
  categoryId: string;
  month: string; // "2026-02"
  amount: number;
}
```

### 4.5 CardBilling（カード請求）
```typescript
interface CardBilling {
  id: string;
  accountId: string; // カードのAccount ID
  month: string; // "2026-02"
  billingAmount: number; // 請求予定額（手動入力）
  dueDate: string; // 引き落とし予定日
  isPaid: boolean; // 支払い済みフラグ
  memo?: string;
}
```

---

## 5. 技術スタック

### フロントエンド
- React 18
- TypeScript 5
- Vite
- Tailwind CSS 3
- React Router（画面遷移）
- Recharts or Chart.js（グラフ表示）
- date-fns（日付操作）

### データ永続化
**localStorage + JSON**
- ブラウザローカルに保存
- オフライン完結
- 実装がシンプル
- 将来的にクラウドDBへの移行も可能

### ホスティング
- AWS S3 + CloudFront（セットアップガイド通り）

### UI/UXライブラリ
- **グラフ表示**: Recharts（React向け、ビジュアル重視）
- **アイコン**: Lucide React or Heroicons
- **日付選択**: React DatePicker
- **モーダル/ダイアログ**: Radix UI or Headless UI

---

## 6. MVP（最小機能セット）

最初に実装すべき機能:

1. **口座管理**
   - 口座/カードの登録・編集・削除
   - 初期残高設定
   - 口座タイプ（夫個人/妻個人/共通）の設定

2. **取引登録**
   - 支出登録（日付、金額、カテゴリ、支払い元、メモ）
   - 収入登録（日付、金額、入金先、メモ）
   - 素早い入力のためのショートカット

3. **取引一覧**
   - 全取引のリスト表示（カード風デザイン）
   - 月別/カテゴリ別/口座別フィルター
   - 取引の編集・削除

4. **ダッシュボード**
   - 今月の収支合計（ビジュアル重視）
   - 各口座の残高（色分け表示）
   - カテゴリ別支出の円グラフ
   - 最近の取引（5-10件）

5. **予算管理**
   - カテゴリ別の月予算設定
   - 予算vs実績の表示（プログレスバー）
   - 予算超過時のアラート表示

6. **カード請求管理**
   - カード別の今月利用額（手動入力可能）
   - 次回請求予定額の手動登録
   - 引き落とし予定日の設定
   - ※将来的には取引データから自動計算も検討

7. **統計画面**
   - 月別収支グラフ（折れ線グラフ）
   - カテゴリ別支出（円グラフ・棒グラフ）
   - 口座別残高推移
   - 予算達成率の可視化

---

## 7. 次のステップ

### Phase 1: プロジェクト初期化
- [ ] GitHubリポジトリ作成
- [ ] Vite + React + TypeScript セットアップ
- [ ] 基本的なディレクトリ構成作成

### Phase 2: データモデル実装
- [ ] TypeScript型定義
- [ ] ローカルストレージAPI実装
- [ ] サンプルデータ作成

### Phase 3: UI実装
- [ ] 基本レイアウト（ナビゲーション）
- [ ] 口座管理画面
- [ ] 取引登録画面
- [ ] ダッシュボード

### Phase 4: 統計・グラフ
- [ ] グラフライブラリ導入
- [ ] 統計画面実装

### Phase 5: デプロイ
- [ ] AWS環境構築
- [ ] CI/CD設定
- [ ] 本番デプロイ

---

## 8. 決定事項

### データ永続化
✅ **localStorage** を採用
- 実装がシンプル
- オフライン完結
- 将来的にクラウドDBへの移行も検討可能

### 予算管理
✅ **MVPに含める**
- カテゴリ別の月予算設定
- 予算vs実績の可視化
- 予算超過アラート

### カード請求管理
✅ **手動入力方式**
- 請求予定額を手動で登録
- 引き落とし予定日の設定
- 将来的には取引データからの自動計算も検討

### 子供の管理
❌ **MVP では不要**
- お小遣い管理などは将来的な追加機能として検討

### デザイン方針
✅ **ビジュアル重視 + シンプルな操作性**
- グラフやチャートを積極的に活用
- 直感的で分かりやすいUI
- カラフルな色分け表示

### 認証
❌ **不要**
- 1人が管理する想定
- 将来的に夫婦で共同管理する場合は追加検討

### レシート画像
❌ **MVP では不要**
- 将来的にS3へのアップロード機能として検討

---

## 9. 将来的な拡張機能（Phase 2以降）

- [ ] クラウドDB連携（複数デバイス同期）
- [ ] レシート画像のアップロードと管理
- [ ] カード請求の自動計算
- [ ] 子供のお小遣い管理
- [ ] 定期支出の自動登録
- [ ] CSV/PDFエクスポート
- [ ] 予算のコピー機能（前月コピー等）
- [ ] 通知機能（予算超過、引き落とし前日等）

---
